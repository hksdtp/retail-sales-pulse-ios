# Test info

- Name: Z-Index Layering Fix - TaskFormDialog Dropdowns >> should display DateTimePicker popover above other elements
- Location: /Users/nih/BaÃÅn leÃâ/retail-sales-pulse-ios/packages/web/tests/z-index-layering-fix.spec.ts:105:3

# Error details

```
Error: page.waitForLoadState: Test timeout of 30000ms exceeded.
=========================== logs ===========================
  "commit" event fired
  "domcontentloaded" event fired
  "load" event fired
============================================================
    at /Users/nih/BaÃÅn leÃâ/retail-sales-pulse-ios/packages/web/tests/z-index-layering-fix.spec.ts:9:16
```

# Page snapshot

```yaml
- region "Notifications (F8)":
  - list
- region "Notifications alt+T"
- img "ICT Logo"
- text: Ph√≤ng Kinh Doanh
- button "M·ªü r·ªông sidebar":
  - img
- navigation:
  - link "Dashboard Dashboard":
    - /url: /
    - img
    - text: Dashboard Dashboard
  - link "C√¥ng vi·ªác C√¥ng vi·ªác":
    - /url: /tasks
    - img
    - text: C√¥ng vi·ªác C√¥ng vi·ªác
  - link "K·∫ø ho·∫°ch K·∫ø ho·∫°ch":
    - /url: /calendar
    - img
    - text: K·∫ø ho·∫°ch K·∫ø ho·∫°ch
  - link "Kh√°ch h√†ng Kh√°ch h√†ng":
    - /url: /customers
    - img
    - text: Kh√°ch h√†ng Kh√°ch h√†ng
  - link "B√°o c√°o B√°o c√°o":
    - /url: /reports
    - img
    - text: B√°o c√°o B√°o c√°o
  - link "Nh√¢n vi√™n Nh√¢n vi√™n":
    - /url: /employees
    - img
    - text: Nh√¢n vi√™n Nh√¢n vi√™n
- button "Kƒê Kh·ªïng ƒê·ª©c M·∫°nh manh@company.com Kh·ªïng ƒê·ª©c M·∫°nh":
  - text: Kƒê
  - paragraph: Kh·ªïng ƒê·ª©c M·∫°nh
  - paragraph: manh@company.com
  - text: Kh·ªïng ƒê·ª©c M·∫°nh
- main:
  - heading "Dashboard" [level=1]
  - paragraph: T·ªïng quan v·ªÅ hi·ªáu su·∫•t kinh doanh ph√≤ng Kinh doanh b√°n l·∫ª - To√†n ph√≤ng ban
  - button "L√†m m·ªõi":
    - img
    - text: L√†m m·ªõi
  - button:
    - img
  - button "B√°o c√°o chi ti·∫øt":
    - img
    - text: B√°o c√°o chi ti·∫øt
  - button "export button":
    - img
    - text: Xu·∫•t b√°o c√°o
  - img "chart bar fill": üìä
  - text: T·ªïng c√¥ng vi·ªác 64
  - img "chart line uptrend xyaxis": üìà
  - text: Ho√†n th√†nh 46
  - img "person 2 fill": üë•
  - text: T·ª∑ l·ªá ho√†n th√†nh 71.9%
  - img "dollarsign circle fill": üí∞
  - text: "Doanh s·ªë 10.2 t·ª∑ VND T·ªïng KTS 6 Tr∆∞·ªõc: 5"
  - img "arrow up": ‚Üë
  - text: 15.2% vs k·∫ø ho·∫°ch
  - img
  - text: "M·ªõi: | C≈©: T·ªïng ƒê·ªëi t√°c 4 Tr∆∞·ªõc: 3"
  - img "arrow up": ‚Üë
  - text: 12.3% vs k·∫ø ho·∫°ch
  - img
  - text: "M·ªõi: | C≈©: T·ªïng Kh√°ch h√†ng 12 Tr∆∞·ªõc: 10"
  - img "arrow up": ‚Üë
  - text: 18.7% vs k·∫ø ho·∫°ch
  - img
  - text: "M·ªõi: | C≈©: T·ªïng B√°o gi√° 9 Tr∆∞·ªõc: 7"
  - img "arrow up": ‚Üë
  - text: 22.1% vs k·∫ø ho·∫°ch
  - img
  - text: "M·ªõi: | C≈©: T·ªïng C√¥ng vi·ªác kh√°c 7 Tr∆∞·ªõc: 6"
  - img "arrow up": ‚Üë
  - text: 8.5% vs k·∫ø ho·∫°ch
  - img
  - text: "M·ªõi: | C≈©: T·ªïng Doanh S·ªë 10.2 t·ª∑ VND Tr∆∞·ªõc: 8.7 t·ª∑ VND"
  - img "arrow up": ‚Üë
  - text: 17.6% vs k·∫ø ho·∫°ch
  - img
  - heading "Doanh thu" [level=3]
  - group:
    - radio "Tu·∫ßn"
    - radio "Th√°ng" [checked]
    - radio "Qu√Ω"
  - img: 0 1500000000 3000000000 4500000000 6000000000
  - list:
    - listitem:
      - img
      - text: Doanh thu
    - listitem:
      - img
      - text: M·ª•c ti√™u
  - heading "Nh√¢n vi√™n xu·∫•t s·∫Øc" [level=3]
  - text: NTN
  - paragraph: Nguy·ªÖn Th·ªã Nga
  - paragraph: Tr∆∞·ªüng nh√≥m
  - paragraph: 2580.5tr
  - paragraph: 35 ƒë∆°n
  - paragraph: 145% m·ª•c ti√™u
  - text: NNV
  - paragraph: Nguy·ªÖn Ng·ªçc Vi·ªát Khanh
  - paragraph: Tr∆∞·ªüng nh√≥m
  - paragraph: 1859.1tr
  - paragraph: 25 ƒë∆°n
  - paragraph: 110% m·ª•c ti√™u
  - text: PTH
  - paragraph: Ph·∫°m Th·ªã H∆∞∆°ng
  - paragraph: Tr∆∞·ªüng nh√≥m
  - paragraph: 1308.4tr
  - paragraph: 28 ƒë∆°n
  - paragraph: 120% m·ª•c ti√™u
  - heading "Ph√¢n b·ªë theo v√πng" [level=3]
  - img:
    - img
    - img
    - text: 51% 49%
  - list:
    - listitem:
      - img
      - text: H√† N·ªôi
    - listitem:
      - img
      - text: TP.HCM
  - heading "T·ª∑ l·ªá chuy·ªÉn ƒë·ªïi" [level=3]
  - text: "B√°o gi√° ‚Üí ƒê∆°n h√†ng 84% T·ª∑ l·ªá chuy·ªÉn ƒë·ªïi: 84% KH ti·ªÅm nƒÉng ‚Üí KH th·ª±c t·∫ø 26% Hi·ªáu qu·∫£ chuy·ªÉn ƒë·ªïi: 26% KTS ti·ªÅm nƒÉng ‚Üí D·ª± √°n 68% T·ª∑ l·ªá th√†nh c√¥ng: 68%"
- region "Notifications (F8)":
  - list
- region "Notifications alt+T"
```

# Test source

```ts
   1 | import { test, expect } from '@playwright/test';
   2 |
   3 | test.describe('Z-Index Layering Fix - TaskFormDialog Dropdowns', () => {
   4 |   test.beforeEach(async ({ page }) => {
   5 |     // Navigate to the app
   6 |     await page.goto('http://127.0.0.1:8088');
   7 |     
   8 |     // Wait for app to load
>  9 |     await page.waitForLoadState('networkidle');
     |                ^ Error: page.waitForLoadState: Test timeout of 30000ms exceeded.
   10 |     
   11 |     // Login if needed (using admin master password)
   12 |     const loginButton = page.locator('button:has-text("ƒêƒÉng nh·∫≠p")');
   13 |     if (await loginButton.isVisible()) {
   14 |       await page.fill('input[type="email"]', 'vietanh@example.com');
   15 |       await page.fill('input[type="password"]', 'haininh1');
   16 |       await loginButton.click();
   17 |       await page.waitForLoadState('networkidle');
   18 |     }
   19 |     
   20 |     // Navigate to Tasks page
   21 |     await page.click('a[href="/tasks"]');
   22 |     await page.waitForLoadState('networkidle');
   23 |   });
   24 |
   25 |   test('should display MultiUserPicker dropdown above image upload section', async ({ page }) => {
   26 |     // Open team task creation dialog
   27 |     await page.click('button:has-text("Giao vi·ªác cho Nh√≥m")');
   28 |     await page.waitForSelector('[role="dialog"]');
   29 |     
   30 |     // Scroll to see both assignment section and image upload section
   31 |     await page.locator('[role="dialog"]').scrollIntoViewIfNeeded();
   32 |     
   33 |     // Fill in required fields first to make form valid
   34 |     await page.fill('input[placeholder*="Nh·∫≠p ti√™u ƒë·ªÅ c√¥ng vi·ªác"]', 'Test Z-Index Fix');
   35 |     await page.fill('textarea[placeholder*="M√¥ t·∫£ chi ti·∫øt"]', 'Testing dropdown visibility over image upload section');
   36 |     
   37 |     // Select a task type
   38 |     await page.click('button:has-text("KTS m·ªõi")');
   39 |     
   40 |     // Open the MultiUserPicker dropdown
   41 |     const userPickerTrigger = page.locator('text=Ch·ªçn ng∆∞·ªùi ƒë∆∞·ª£c giao vi·ªác');
   42 |     await userPickerTrigger.click();
   43 |     
   44 |     // Wait for dropdown to appear
   45 |     await page.waitForSelector('[data-testid="user-dropdown"]', { timeout: 2000 }).catch(() => {
   46 |       // If data-testid doesn't exist, try alternative selector
   47 |       return page.waitForSelector('input[placeholder*="T√¨m ki·∫øm ng∆∞·ªùi d√πng"]', { timeout: 2000 });
   48 |     });
   49 |     
   50 |     // Check that dropdown is visible and not covered
   51 |     const dropdown = page.locator('input[placeholder*="T√¨m ki·∫øm ng∆∞·ªùi d√πng"]').locator('..').locator('..');
   52 |     await expect(dropdown).toBeVisible();
   53 |     
   54 |     // Verify dropdown has correct z-index
   55 |     const dropdownElement = await dropdown.first().elementHandle();
   56 |     if (dropdownElement) {
   57 |       const zIndex = await page.evaluate((el) => {
   58 |         return window.getComputedStyle(el).zIndex;
   59 |       }, dropdownElement);
   60 |       
   61 |       // Should have z-index higher than dialog (10000)
   62 |       expect(parseInt(zIndex)).toBeGreaterThan(10000);
   63 |     }
   64 |     
   65 |     // Verify image upload section is still visible but below dropdown
   66 |     const imageUploadSection = page.locator('text=H√¨nh ·∫£nh ƒë√≠nh k√®m');
   67 |     await expect(imageUploadSection).toBeVisible();
   68 |     
   69 |     // Test interaction with dropdown
   70 |     const searchInput = page.locator('input[placeholder*="T√¨m ki·∫øm ng∆∞·ªùi d√πng"]');
   71 |     if (await searchInput.isVisible()) {
   72 |       await searchInput.fill('test');
   73 |       // Should be able to type without issues
   74 |       await expect(searchInput).toHaveValue('test');
   75 |     }
   76 |   });
   77 |
   78 |   test('should display SmartInput suggestions above other elements', async ({ page }) => {
   79 |     // Open task creation dialog
   80 |     await page.click('button:has-text("T·∫°o c√¥ng vi·ªác")');
   81 |     await page.waitForSelector('[role="dialog"]');
   82 |     
   83 |     // Type in title to trigger suggestions
   84 |     const titleInput = page.locator('input[placeholder*="Nh·∫≠p ti√™u ƒë·ªÅ c√¥ng vi·ªác"]');
   85 |     await titleInput.fill('Kh·∫£o s√°t');
   86 |     
   87 |     // Wait for suggestions to appear (if any)
   88 |     await page.waitForTimeout(500);
   89 |     
   90 |     // Check if suggestions dropdown appears
   91 |     const suggestionsDropdown = page.locator('[data-testid="suggestions-dropdown"]');
   92 |     if (await suggestionsDropdown.isVisible()) {
   93 |       // Verify suggestions have correct z-index
   94 |       const dropdownElement = await suggestionsDropdown.first().elementHandle();
   95 |       if (dropdownElement) {
   96 |         const zIndex = await page.evaluate((el) => {
   97 |           return window.getComputedStyle(el).zIndex;
   98 |         }, dropdownElement);
   99 |         
  100 |         expect(parseInt(zIndex)).toBeGreaterThan(10000);
  101 |       }
  102 |     }
  103 |   });
  104 |
  105 |   test('should display DateTimePicker popover above other elements', async ({ page }) => {
  106 |     // Open task creation dialog
  107 |     await page.click('button:has-text("T·∫°o c√¥ng vi·ªác")');
  108 |     await page.waitForSelector('[role="dialog"]');
  109 |     
```